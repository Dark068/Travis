workflows:
  build-suhani-workflow:
    name: Build and Run Suhani Binary and Python Script
    environment:
      vars:
        BINARY_NAME: suhani
    scripts:
      - echo "Checking system environment and Python version"
      - python3 --version || echo "Python not found!"
      - echo "Upgrading pip and installing dependencies"
      - python3 -m pip install --upgrade pip
      - python3 -m pip install telebot pymongo aiohttp flask aiogram pyTelegramBotAPI python-telegram-bot
      - echo "Setting execute permissions for the binary"
      - chmod +x $BINARY_NAME
      - echo "Verifying architecture compatibility (macOS)"
      - uname -a
      - file ./$BINARY_NAME
      - echo "Running the binary file"
      - ./suhani || echo "Binary execution failed, check logs"
      - echo "Running the Python script"
      - python3 suhani.py
